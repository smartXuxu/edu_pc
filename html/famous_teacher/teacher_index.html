<!DOCTYPE html>
<html>
<head lang="en">
    <link rel="shortcut icon " type="images/x-icon" href="../../ico.ico">

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>教师主页</title>
    <!-- Bootstrap -->
    <link href="../../css/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link href="../../css/mui.min.css" rel="stylesheet">
    <link href="../../css/mui_img.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/sweetalert2.css" rel="stylesheet">
    <link href="../../css/iconfont.css" rel="stylesheet">
    <link href="../../css/index/edu_index.css" rel="stylesheet">
    <link href="../../css/index/teacher_index.css" rel="stylesheet">
</head>
<body>
<div class="layer">
    <div class="header"></div>
    <div class="main">
        <div class="content p_center clearfix">
            <h5>当前位置：首页>名师</h5>
            <div class="mine_left f_left">
                <div class="left_top">
                    <div class="box_img">
                    </div>
                    <div class="left_top_center">
                        <!--tiancong -->
                    </div>
                </div>
                <div class="left_middle">
                    <p class="active">ta动态</p>
                    <p>主讲课程</p>
                    <p>课堂问答</p>
                    <p>学生评价</p>
                </div>
                <div class="left_bottom">
                    <span>关注微信公众号</span>
                    <img src="../../img/code.png" alt=""/>
                    <span>下载猴姆教学APP</span>
                    <img src="../../img/code.png" alt=""/>
                </div>
            </div>
            <div class="mine_right f_right">
                <!--个人信息-->
                <div class="mine_info clearfix">
                    <!-- <div class="in_left f_left">
                         <h5>胡晓霞 <em class="iconfont icon-mingpian"></em> <i class="iconfont icon-v"></i></h5>
                         <p>性别：女</p>
                         <p>任职：华南师范大学附属中学</p>
                         <p>主讲：初二 初三 数学 语文</p>
                     </div>
                     <div class="in_right f_right">
                         <p>
                             <span>659</span>
                             <em>学生</em>
                         </p>
                         <p>
                             <span>659</span>
                             <em>粉丝</em>
                         </p>
                         <p>
                             <span>659</span>
                             <em>获赞</em>
                         </p>
                     </div>-->
                </div>
                <div class="item dynamic">
                    <div class="content_lists">

                        <!--<div class="content_list">
                            <div class="list_top clearfix" onclick="location.href='./dynamic_detail.html'">
                                <img src="../../img/focus-img1.png" alt=""/>
                                <span>小鸟</span>
                                <em>1天前 </em>
                            </div>
                            <div class="list_content" onclick="location.href='./dynamic_detail.html'">
                                今天学习了初二数学上期的内容，感觉有点难，但我会努力加油学习的！今天学习了初二数学上期的内容，感觉有点难，但努力加油学习的！今
                            </div>
                            <div class="img_cover">
                                <div class="img_box">
                                    <img src="../../img/focus-img1.png" alt=""/>
                                </div>
                                <div class="img_box">
                                    <img data-preview-src="" data-preview-group="1" src="../../img/focus-img1.png" alt=""/>
                                </div><div class="img_box">
                                <img data-preview-src="" data-preview-group="1" src="../../img/focus-img1.png" alt=""/>
                            </div><div class="img_box">
                                <img data-preview-src="" data-preview-group="1" src="../../img/focus-img1.png" alt=""/>
                            </div>
                            </div>
                            <div class="list_footer">
                                <ul class="clearfix">
                                    <li ><em class="hand iconfont icon-like "> 1516</em></li>
                                    <li><em class="comment iconfont icon-xiaoxi1"> 1516</em></li>
                                    &lt;!&ndash; <li><em class="comment iconfont icon-zhuyi"> 举报</em></li>&ndash;&gt;
                                </ul>
                            </div>
                        </div>-->
                    </div>

                </div>
                <div class="item course">
                    <!--//2-->
                </div>
                <div class="item request">
                    <!--<div class="all_question_list" onclick="location.href='./request/request_detail.html'">
                        <div class="qust_top">
                            <img src="../../img/focus-img1.png" alt="">张大大
                            <span>来源：如果两条直线和第三条直线来源：如果两条直线和第三条直线来源：如果两条直线和第三条直线平行，这两条直线也平行</span>
                        </div>
                        <div class="qust_middle">
                            我是问答标题最多64字我是问答标题最多64字我是问答标题最多64字我是问答标题最多64字我是问答标 题最多64字我是问答标题最
                        </div>
                        &lt;!&ndash;判断有没有 图片 类名&ndash;&gt;
                        <div class="qust_content">
                            <img src="../../img/focus-img1.png" alt="">
                            <div class="qust_con_mi">
                                我是第一个回答详情内容我是第一个回答详情内容我是第一个回答详情内容我是第一个回答详情  我是第一个回答详情内容我是第一个回答详情内容我是第一个回答详情内容我是第一个回答详情内容我是第一个回 答详情内容我是第一个回答
                            </div>
                        </div>
                        <div class="qust_footer">
                            <ul class="clearfix">
                                <li>2198次浏览</li>
                                <li class="iconfont icon-xiaoxi1"> 2198个回答</li>
                                <li class="iconfont icon-zhuyi" onclick="location.href='./report.html'"> 举报</li>
                            </ul>
                        </div>
                    </div>-->
                </div>
                <div class="item eva">
                    <!--分页-->
                    <div>
                        <!--   <h3 class="clearfix">共 <i>912</i>评价
                               <em class="iconfont icon-star"></em>
                               <em class="iconfont icon-star"></em>
                               <em class="iconfont icon-star"></em>
                               <em class="iconfont icon-star"></em>
                               <em class="iconfont icon-star"></em>
                               <s>9.3分</s>
                               <span class="f_right" onclick="location.href='./eva.html'">我要评价</span>
                           </h3>-->
                        <!-- <div class="eva_lists">
                             &lt;!&ndash;  <div class="eva_list">
                                       <div class="list_top clearfix">
                                           <img src="../../img/focus-img1.png" alt=""/>
                                           <span>张大大</span>
                                           <em class="iconfont icon-star"></em>
                                           <em class="iconfont icon-star"></em>
                                           <em class="iconfont icon-star"></em>
                                           <em class="iconfont icon-star"></em>
                                           <em class="iconfont icon-star"></em>
                                           <i>9.3分</i>
                                           <s class="f_right">2018-07-13 18:20</s>
                                       </div>
                                   <div class="list_middle">
                                       我是一条评论内容我是一条评论内容我是一条评论内容我是一条评论内容我是一条评论内容我是一条评论内容我是一条评论内容我是 我是一条
                                   </div>

                               </div>
                               <div class="eva_list">
                                       <div class="list_top clearfix">
                                           <img src="../../img/focus-img1.png" alt=""/>
                                           <span>张大大</span>
                                           <em class="iconfont icon-star"></em>
                                           <em class="iconfont icon-star"></em>
                                           <em class="iconfont icon-star"></em>
                                           <em class="iconfont icon-star"></em>
                                           <em class="iconfont icon-star"></em>
                                           <i>9.3分</i>
                                           <s class="f_right">2018-07-13 18:20</s>
                                       </div>
                                   <div class="list_middle">
                                       我是一条评论内容我是一条评论内容我是一条评论内容我是一条评论内容我是一条评论内容我是一条评论内容我是一条评论内容我是 我是一条
                                   </div>&ndash;&gt;
                         </div>    -->
                    </div>
                    <!--   <nav aria-label="Page navigation" class="Page">
                           <ul class="pagination">
                               <li>
                                   <a href="#" aria-label="Previous">
                                       <span aria-hidden="true">&laquo;</span>
                                   </a>
                               </li>
                               <li><a href="#">1</a></li>
                               <li><a href="#">2</a></li>
                               <li><a href="#">3</a></li>
                               <li><a href="#">4</a></li>
                               <li><a href="#">5</a></li>
                               <li>
                                   <a href="#" aria-label="Next">
                                       <span aria-hidden="true">&raquo;</span>
                                   </a>
                               </li>
                           </ul>
                       </nav>-->
                </div>
            </div>
        </div>

    </div>
</div>
<div class="footer"></div>
</div>
</body>
<!-- HTML5 shim 和 Respond.js 是为了让 IE8 支持 HTML5 元素和媒体查询（media queries）功能 -->
<!-- 警告：通过 file:// 协议（就是直接将 html 页面拖拽到浏览器中）访问页面时 Respond.js 不起作用 -->
<!--[if lt IE 9]>
<script src="../../js/bootstrap/html5shiv.main.js"></script>
<script src="../../js/bootstrap/respond.min.js"></script>
<![endif]-->
<!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
<script src="../../js/jquery.min.js"></script>
<script src="../../js/template-web.js"></script>
<script src="../../js/template.js"></script>
<script>
    template.helper("spl",function(str){
        return str.split(",");
    });
    template.helper("time",function(date){
        var time=new Date(date).toLocaleString().replace(/:\d{1,2}$/,' ').substr(5,20).replace(/\//g,"-");
        return time;
    });
    template.helper("str",function(str){
        return parseInt(str);
    });

</script>
<!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
<script src="../../js/bootstrap/bootstrap.min.js"></script>
<script src="../../js/base.js"></script>
<script src="../../js/mui.min.js"></script>
<script src="../../js/mui.zoom.js"></script>
<script src="../../js/mui.preview.js"></script>
<script src="../../js/sweetalert2.js"></script>

<script type="text/html" id="replay">
    <img src="{{data.teacher.portrait==null?'../../img/logo.png':data.teacher.portrait}}" alt=""/>
    <div class="reply">
        {{if data.WhetherAttention==false}}
        <button class="attention"> +  关注</button>
        {{else}}
        <button class="attention"> 取消关注</button>
        {{/if}}
        {{if data.WhetherLove==false}}
        <button class="hand iconfont icon-xin"> <s>取消点赞</s></button>
        {{else}}
        <button class="hand iconfont icon-xin"> <s>取消点赞</s></button>
        {{/if}}
    </div>
</script>
<script type="text/html" id="baseInfo">
    <div class="in_left f_left">
        <h5>{{data.teacher.nickname==null?data.teacher.realName==null?"猴姆教学":data.teacher.realName:data.teacher.nickname}} <em class="iconfont icon-mingpian"></em> <i class="iconfont icon-v"></i></h5>
        <p>性别：{{data.teacher.gender}}</p>
        <p>任职：{{data.schoolName}}</p>
        <p>主讲：{{data.teacher.teachingSubjects}}</p>
    </div>
    <div class="in_right f_right">
        <p>
            <span>{{data.StudentNum}}</span>
            <em>学生</em>
        </p>
        <p>
            <span>{{data.FansNum}}</span>
            <em>粉丝</em>
        </p>
        <p>
            <span>{{data.LoveNum}}</span>
            <em>获赞</em>
        </p>
    </div>
</script>
<!--评价-->
<script type="text/html" id="eva">
    {{if data == null||data.length==0}}
    <div class="no_in">对不起，暂时没有评价</div>
    {{else}}
    <h3 class="clearfix">共 <i>{{data==null?0:data.evaluateTeacherNum}}</i>评价
        <span class="f_right" onclick="location.href='./eva.html?teacherID={{data.evaluateTeacherList[0].evaluateTeacher.userid}}'">我要评价</span>
    </h3>
    <div class="eva_lists">
        {{each data.evaluateTeacherList as value i}}
        <div class="eva_list">
            <div class="list_top clearfix">
                <img src="{{value.user.portrait==null?'../../img/logo%20(2).png':value.user.portrait}}" alt=""/>
                <span>{{value.user.nickname==null?value.user.realName==null?"猴姆教学":value.user.realName:value.user.nickname}}</span>
                {{if str(value.evaluateTeacher.score) ==1}}
                <em class="iconfont icon-star"></em>
                {{else if str(value.evaluateTeacher.score) ==2}}
                <em class="iconfont icon-star"></em>
                <em class="iconfont icon-star"></em>
                {{else if str(value.evaluateTeacher.score) ==3}}
                <em class="iconfont icon-star"></em>
                <em class="iconfont icon-star"></em>
                <em class="iconfont icon-star"></em>
                {{else if str(value.evaluateTeacher.score) ==4}}
                <em class="iconfont icon-star"></em>
                <em class="iconfont icon-star"></em>
                <em class="iconfont icon-star"></em>
                <em class="iconfont icon-star"></em>
                {{else}}
                <em class="iconfont icon-star"></em>
                <em class="iconfont icon-star"></em>
                <em class="iconfont icon-star"></em>
                <em class="iconfont icon-star"></em>
                <em class="iconfont icon-star"></em>
                {{/if}}
                <i>{{value.evaluateTeacher.score}}分</i>
                <s class="f_right">{{value.evaluateTeacher.updateTime==null?"时间不详":time(value.evaluateTeacher.updateTime)}}</s>
            </div>
            <div class="list_middle">
                {{value.evaluateTeacher.body}}
            </div>
        </div>
        {{/each}}
    </div>
    {{if data!==null||data.length==5}}
    <div class="see_more" onclick="location.href='./teacher_recomment.html?teacherID={{data.evaluateTeacherList[0].evaluateTeacher.userid}}'">查看更多>>></div>
    {{/if}}
    {{/if}}
</script>
<!--课堂问答-->
<script type="text/html" id="request">
    {{if data==null||data.length==0||!data}}
    <div class="no_in">对不起，暂时没有课堂问答喔</div>
    {{else}}
    {{each data as value i}}
    <!--<div class="all_question_list" onclick="location.href='../request/request_detail.html?queationId={{value.questions.id}}'">-->
    <div class="all_question_list" >
        <div class="qust_top">
            <img src="{{value.questionuser.portrait==null?'../../img/logo%20(2).png':value.questionuser.portrait}}" alt="">{{value.questionuser.nickname==null?value.questionuser.realName==null?"暂无设置":value.questionuser.realName:value.questionuser.nickname}}
            <!--<span>来源：如果两条直线和第三条直线来源：如果两条直线和第三条直线来源：如果两条直线和第三条直线平行，这两条直线也平行</span>-->
        </div>
        <div class="qust_middle">
           {{value.questions.title}}
        </div>
        <!--判断有没有 图片 类名-->
        <div class="qust_content">
            <!--<img src="../../img/focus-img1.png" alt="">-->
            <div class="qust_con_mi">
                {{value.questions.body}}
            </div>
        </div>
        <div class="qust_footer">
            <ul class="clearfix">
                <i class="iconfont icon-huangguan"></i>悬赏：{{value.questions.reward}}积分
                <li class="iconfont icon-xiaoxi1"> {{value.answerNum}}个回答</li>
                <li class="iconfont icon-zhuyi" onclick="location.href='./report.html?id={{value.questionuser.userid}}'"> 举报</li>
            </ul>
        </div>
    </div>
    {{/each}}
    {{/if}}
</script>
<script type="text/html" id="course">
    {{if data == null||data.length==0}}
    <div class="no_in">对不起，暂时没有课程可以展示</div>
    {{else}}
    <ul>
    {{each data as value i}}
    <li>
        <a href="../lesson/video.html?id={{value.course.id}}">
            <img src='{{value.course.coursePicture==null?"../../img/logo.png":value.course.coursePicture}}' onerror="this.src='../../img/logo.png'" alt=""/>
            <div class="center">
                <div class="top clearfix">
                    <span>{{value.course.version==null||value.course.version==""?"未设置":value.course.version}}</span>
                    {{value.course.academicYear}}{{value.course.grade}}{{value.course.subject}}{{value.course.semester}}{{value.course.name}}
                </div>
                <!-- <h5>8小时20分钟</h5>-->
                <p>更新第{{value.updateNum}}课时</p>
                <div class="c_b">
                    <em class="iconfont icon-wode1"> {{value.StudyCourseNum}}</em>
                    <em class="iconfont icon-wujiaoxingkong"> {{value.CollectNum}}</em>
                    <em class="iconfont icon-xin1"> {{value.LoveNum}}</em>
                    <!-- <em>★</em>
                     <em>★</em>
                     <em>★</em>
                     <em>★</em>
                     <em>★</em>
                     9.6分
                     <span>1.6W人学习</span>-->
                </div>
            </div>
            <div class="cr_right">
                <button>立即学习</button>
                <!-- <div class="share">
                     <i class="iconfont icon-changyonglogo28"></i>
                     <i class="iconfont icon-qq1"></i>
                     <i class="iconfont icon-weibo"></i>
                     <i class="iconfont icon-kongjian"></i>
                 </div>-->
            </div>
        </a>
    </li>
    {{/each}}
    </ul>
    {{/if}}
</script>
<script type="text/html" id="dynamic">
    {{if data==null||data.length==0}}
    <div class="no_in">对不起，暂时没有动态</div>
    {{else}}
    {{each data as value i}}
    <div class="content_list">
        <!-- <div class="list_top clearfix" onclick="location.href='../request/dynamic_detail.html?dynamicid={{value.dynamic.id}}'">-->
        <div class="list_top clearfix">
            <img src="{{value.user.portrait==null?'../../img/logo%20(2).png':value.user.portrait}}" alt=""/>
            <span>{{value.user.nickname==null?value.user.realName==null?"猴姆教学":value.user.realName:value.user.nickname}}</span>
            <em>1天前 </em>
        </div>
        <div class="list_content" onclick="location.href='../request/dynamic_detail.html'">
            {{value.dynamic.body}}
        </div>
            {{if value.dynamic.picture==null||value.dynamic.picture==""}}
            {{else}}
        <div class="img_cover">
            {{each spl(value.dynamic.picture) as img k}}
            <div class="img_box">
                <img src="{{img}}" alt="" data-preview-src="" data-preview-group="{{i}}"/>
            </div>
            {{/each}}
        </div>
            {{/if}}

        <div class="list_footer">
            <ul class="clearfix">
                <!--判断是否点赞-->
                {{if value.love.是否点赞 =="否"}}
                <li class="hand" data-id='{{value.dynamic.id}}'><em class="iconfont icon-like"> {{value.love.点赞总数}}</em></li>
                {{else}}
                <li  class="hand" data-id='{{value.dynamic.id}}'><em class="iconfont icon-like is_hand"> {{value.love.点赞总数}}</em></li>
                {{/if}}
                <li><em class="comment iconfont icon-xiaoxi1"> {{value.commentNum}}</em></li>
                 <li><em class="comment ">浏览{{value.dynamic.previewNum}}次</em></li>
            </ul>
        </div>
    </div>
    {{/each}}
{{if data!==null||data.length==5}}
    <div class="see_more" onclick="location.href='./teacher_dynamic.html?id={{data[0].dynamic.userId}}'">查看更多>>></div>
    {{/if}}
    {{/if}}
</script>
<script>
    template.helper("spl",function(str){
        return str.split(",");
    });
    $(function () {
        mui.previewImage();
        mui('body').on('tap','a',function(){document.location.href=this.href;});
        setTimeout(function () {
            $(".header").load("../common/header_logo.html");
            $(".footer").load("../common/footer.html");
        },100);
        $(".sub>span").click(function () {
            $(this).addClass("active").siblings().removeClass("active");
            console.log($(this).text());
        })
        setTimeout(function () {
            $("header>nav>ul>li:nth-of-type(4)").addClass("active").siblings().removeClass("active");
        },300)

        /*切换 课程和教师*/
        $(".left_middle>p").click(function () {
//jQuery index的属性
            var index = $(this).index();
            console.log(index);
            $(this).addClass("active").siblings().removeClass("active");
            $('.item').eq(index).show().siblings(".item").hide();
        })
        //渲染  进入到教师主页的基本信息
        var teacherid=location.href.split("=")[1];
        var userid=localStorage.getItem("this_userid");
        // 点赞
        function loveTec(e){
            myAjax({url:"/dynamic/update/Love/Teacher",
                data:{userid:userid,
                    teacherid :teacherid
                },type:"post"}, function (data) {
                console.log(data);
                if(data.status==200){
                    if(data.data.love==true){
                        $(e).children("s").text("取消点赞")
                    }else{
                        $(e).children("s").text("点赞")
                    }
                }
            })
        }
        $(".main").on("click",".hand", function () {
            loveTec(this)
        })
        //关注
        function attTec(e){
            myAjax({url:"/dynamic/update/Attention/User",
                data:{fansId:userid,
                    beFocusedUserid:teacherid
                },type:"post"}, function (data) {
                console.log(data);
                if(data.status==200){
                    if(data.data.attention==true){
                        $(e).text("取消关注")
                    }else{
                        $(e).text("+ 关注")
                    }
                }
            })
        }
        $(".main").on("click",".attention", function () {
            attTec(this)
        })

        myAjax({url:"/teacher/related/get/Teacher/BaseInfo",
                    data:{teacherid:teacherid,userid:userid},
                    type:"post"},
                function (data) {
                    console.log(data);
                    if(data.status==200){
                        $(".mine_info").html(template("baseInfo",data));
                        $(".left_top_center").html(template("replay",data));
                    }
                })
        //查看当前教师的动态
        //查看教师动态
        dynamic(1)
        function dynamic(page){
            myAjax({url:"/teacher/related/get/Dynamic/List",
                data:{teacherid:teacherid,
                    userId:userid,
                    page:1,
                    size:5},type:"post"}, function (data) {
                console.log(data);
                if(data.status==200){
                    $(".dynamic .content_lists").html(template("dynamic",data));
                }
            })
        }

        //主讲课程
        myAjax({url:"/teacher/related/get/Teacher/CourseList",
            data:{teacherid:teacherid},
            type:"post"}, function (data) {
            console.log(data);
             if(data.status==200){
             $(".course").html(template("course",data))
             }
        })
        //课堂问答
        myAjax({url:"/teacher/related/get/Course/QuestionAnswer",
            data:{teacherid:teacherid},
            type:"post"}, function (data) {
            console.log(data);
            if(data.status==200){
             /*template.helper("time",function(date){
             var time=new Date(date).toLocaleString().replace(/:\d{1,2}$/,' ').substr(0,9).replace(/\//g,"-");
             return time;
             });*/
             $(".request").html(template("request",data))
             }
        })
        //学生评价
        $(".write_submit").click(function () {
            location.href='./write_submit.html?id='+teacherid;
        })
        myAjax({url:"/teacher/related/get/Teacher/Evaluate/List",
            data:{teacherid:teacherid,page:1,size:5},
            type:"post"}, function (data) {
            console.log(data);
            if(data.status==200){
                /**/
                $(".eva>div").html(template("eva",data))
            }
        })
        /*点赞*/
        //点赞
        $(".main").on("click",'.hand', function () {
            var id=$(this).data("id");
            console.log(id);
            loveDynamic(id,this);
        })
        function loveDynamic(id,e){
            myAjax({url:"/dynamic/update/Love/Dynamic",data:{"userid":userid,"dynamicid":id},type:"post",async:false}, function (data) {
                console.log(data);
                if(data.status==200){
                    if(data.data.love.是否点赞=="否"){
                        /*去掉类名*/
                        $(e).children("em").removeClass("is_hand");
                        $(e).children("em").text(" "+data.data.love.点赞总数);
                    }else{
                        $(e).children("em").addClass("is_hand");
                        $(e).children("em").text(" "+data.data.love.点赞总数);
                    }
                    //重绘页面不行了
                    /* dynamic(1,3,localStorage.getItem("this_userid"));*/
                }
            })
        }
        // 分页的调用
        var page=1;
        var pro=1;
       $(".dynamic").on("click",".Page>ul>li", function () {
              console.log($(this));
               page=$(this)[0].innerText;
               // 判断page 的类型
               //console.log(page);//5
               if(typeof(parseInt(page)) =="number"&& !isNaN(parseInt(page))){
                   /*是数字*/
                   pro=page;
               }else{
                   /*是分页*/
                   if(page=="»"){
                       /*分页+*/
                       pro=parseInt(pro-0+1);
                       page=pro;

                   }else {
                       /*分页-*/
                       pro=parseInt(pro-1);
                       page=pro;
                   }
               }
               if(parseInt(page)<=0){
                   page=1;
                   pro=1;
               }
               console.log(page);
               dynamic(page);
       })
    })
</script>
</html>